<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marinestream Pricing Calculator</title>
    <style>
        :root {
            --primary: #0056b3;
            --primary-light: #e6f0fa;
            --secondary: #6c757d;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
            --light: #f8f9fa;
            --dark: #343a40;
            --white: #ffffff;
            --body-bg: #f5f7fa;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: var(--body-bg);
            padding: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background-color: var(--primary);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        header h1 {
            margin-bottom: 10px;
        }
        
        .description {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        
        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .card {
            background: var(--white);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
        }
        
        .card h2 {
            color: var(--primary);
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .card h2 .info-icon {
            margin-left: 10px;
            cursor: help;
            color: var(--primary);
            font-size: 18px;
        }
        
        .card-description {
            color: var(--secondary);
            margin-bottom: 15px;
            font-size: 0.95rem;
        }
        
        .form-group {
            margin-bottom: 15px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .tooltip-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            background-color: var(--primary);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 16px;
            font-size: 12px;
            margin-left: 5px;
            cursor: help;
            position: relative;
        }
        
        .tooltip-text {
            visibility: hidden;
            width: 250px;
            background-color: var(--dark);
            color: var(--white);
            text-align: left;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-weight: normal;
            font-size: 0.8rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--dark) transparent transparent transparent;
        }
        
        .tooltip-icon:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        
        input[type="number"], select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .slider-container input[type="range"] {
            flex-grow: 1;
        }
        
        .slider-value {
            min-width: 40px;
            text-align: right;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .table th, .table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        
        .results {
            margin-top: 20px;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .result-label {
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        
        .metric-card {
            background: linear-gradient(to right, #0056b3, #007bff);
            color: white;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .metric-title {
            font-size: 1rem;
            margin-bottom: 10px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: 700;
        }
        
        .metric-subtitle {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .chart-container {
            height: 350px;
            margin-top: 20px;
        }
        
        .profit-positive {
            color: var(--success);
        }
        
        .profit-negative {
            color: var(--danger);
        }
        
        footer {
            text-align: center;
            padding: 20px 0;
            margin-top: 40px;
            color: var(--secondary);
            font-size: 0.9rem;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--primary);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: #004494;
        }
        
        .btn-reset {
            background-color: var(--secondary);
            margin-left: 10px;
        }
        
        .btn-reset:hover {
            background-color: #5a6268;
        }
        
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 8px;
        }
        
        .badge-success {
            background-color: var(--success);
            color: white;
        }
        
        .badge-warning {
            background-color: var(--warning);
            color: #212529;
        }
        
        .badge-danger {
            background-color: var(--danger);
            color: white;
        }
        
        .progress {
            height: 10px;
            background-color: #e9ecef;
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--primary);
            transition: width 0.3s ease;
        }
        
        .progress-bar-danger {
            background-color: var(--danger);
        }
        
        .progress-bar-warning {
            background-color: var(--warning);
        }
        
        .progress-bar-success {
            background-color: var(--success);
        }
        
        .callout {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 6px;
            background-color: var(--primary-light);
            border-left: 4px solid var(--primary);
        }
        
        .callout-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary);
        }
        
        .callout-text {
            font-size: 0.9rem;
            color: var(--dark);
        }
        
        .tab-container {
            margin-bottom: 20px;
        }
        
        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 15px;
        }
        
        .tab-button {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: var(--secondary);
            border-bottom: 3px solid transparent;
        }
        
        .tab-button.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .action-buttons {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        /* Added styles for scenarios */
        .scenario-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .scenario-button {
            background-color: var(--light);
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .scenario-button:hover {
            background-color: var(--primary-light);
            border-color: var(--primary);
        }
        
        .scenario-button.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Help panel styles */
        .help-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100%;
            background-color: white;
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            overflow-y: auto;
            transition: right 0.3s ease;
            z-index: 1000;
        }
        
        .help-panel.open {
            right: 0;
        }
        
        .help-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .close-help {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary);
        }
        
        .help-section {
            margin-bottom: 20px;
        }
        
        .help-section h3 {
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .help-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 999;
            font-size: 24px;
        }

        /* Switch styling */
        .switch-container {
            display: flex;
            align-items: center;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
            margin-right: 10px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary);
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        /* Currency selector styling */
        .currency-selector {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px;
            background-color: var(--primary-light);
            border-radius: 8px;
        }

        .currency-selector label {
            margin-bottom: 0;
            white-space: nowrap;
        }

        .currency-selector select {
            width: auto;
            flex-grow: 0;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Marinestream Pricing Calculator</h1>
            <p class="description">Optimize your SaaS pricing strategy for digital twin and workflow management in the marine industry</p>
        </div>
    </header>
    
    <main class="container">
        <!-- Introduction callout -->
        <div class="callout">
            <div class="callout-title">How to use this calculator</div>
            <div class="callout-text">
                This tool helps you model different pricing scenarios for Marinestream's vessel management software. Adjust cost structures, pricing components, and customer usage to see the impact on revenue, profit margins, and break-even points. Use the pre-defined scenarios or create your own to find the optimal pricing strategy.
            </div>
        </div>
        
        <!-- Currency selector -->
        <div class="currency-selector">
            <label for="currency-select">Select Currency:</label>
            <select id="currency-select">
                <option value="AUD">Australian Dollar (AUD)</option>
                <option value="USD">US Dollar (USD)</option>
                <option value="GBP">British Pound (GBP)</option>
            </select>
            <span id="exchange-rate-info">Base currency: AUD</span>
        </div>

        <!-- Scenario selector -->
        <div class="card">
            <h2>Quick Scenarios</h2>
            <div class="card-description">Select a pre-defined scenario or create your own custom pricing model.</div>
            <div class="scenario-buttons">
                <button class="scenario-button" id="scenario-conservative">Conservative Growth</button>
                <button class="scenario-button" id="scenario-balanced">Balanced Approach</button>
                <button class="scenario-button" id="scenario-aggressive">Aggressive Growth</button>
                <button class="scenario-button active" id="scenario-custom">Custom Model</button>
            </div>
        </div>

        <div class="calculator-grid">
            <div>
                <div class="card">
                    <h2>
                        Cost Structure
                        <span class="info-icon" title="Your fixed and variable costs">ⓘ</span>
                    </h2>
                    <div class="card-description">
                        These are the costs associated with running Marinestream, including the Rise-X platform fees and operational expenses.
                    </div>
                    <div class="form-group">
                        <label for="riseX-fee">
                            Rise-X Monthly Fee
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The monthly fee paid to Rise-X for their SaaS platform, which includes 1,929 state transitions.</span>
                            </span>
                        </label>
                        <input type="number" id="riseX-fee" value="6750" min="0" step="10">
                    </div>
                    <div class="form-group">
                        <label for="included-events">
                            Included State Transitions
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The number of state transitions (events) included in the Rise-X monthly fee. Each maintenance job typically has 5 transitions: open, resource, work, review, close.</span>
                            </span>
                        </label>
                        <input type="number" id="included-events" value="1929" min="0">
                    </div>
                    <div class="form-group">
                        <label for="additional-costs">
                            Additional Monthly Costs
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">Additional costs for development, support, marketing, and other operational expenses not covered by the Rise-X fee.</span>
                            </span>
                        </label>
                        <input type="number" id="additional-costs" value="2000" min="0" step="10">
                    </div>
                    <div class="form-group">
                        <label for="prepay-discount">
                            Annual Pre-Payment Discount
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">Discount offered by Rise-X for pre-paying the subscription. Longer commitments provide higher discounts.</span>
                            </span>
                        </label>
                        <select id="prepay-discount">
                            <option value="0">None (0%)</option>
                            <option value="0.17">1 Year (17% off)</option>
                            <option value="0.25">2 Years (25% off)</option>
                            <option value="0.31">3 Years (31% off)</option>
                        </select>
                    </div>
                    <div class="form-group switch-container">
                        <label class="switch">
                            <input type="checkbox" id="include-developer">
                            <span class="slider"></span>
                        </label>
                        <label for="include-developer">
                            Include Software Developer (100,000 AUD/year)
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">Add the annual cost of a full-time software developer to your expenses.</span>
                            </span>
                        </label>
                    </div>
                    <div class="callout">
                        <div class="callout-title">Special Condition</div>
                        <div class="callout-text">
                            Additional events beyond the included 1,929 per month are provided at no extra charge until December 2026, offering significant growth potential without increased platform costs.
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h2>
                        Pricing Components
                        <span class="info-icon" title="Your pricing strategy">ⓘ</span>
                    </h2>
                    <div class="card-description">
                        Set your pricing components for the new billing model.
                    </div>
                    <div class="form-group">
                        <label for="annual-subscription-fee">
                            Annual Subscription Fee
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The base annual fee charged to each customer for access to the platform.</span>
                            </span>
                        </label>
                        <input type="number" id="annual-subscription-fee" value="2000" min="0" step="100">
                    </div>
                    <div class="form-group">
                        <label for="per-vessel-fee">
                            Cost Per Vessel
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The fee charged for each vessel added to the platform.</span>
                            </span>
                        </label>
                        <input type="number" id="per-vessel-fee" value="200" min="0" step="10">
                    </div>
                    <div class="form-group">
                        <label for="per-work-item-fee">
                            Cost Per Work Item
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The fee charged for each work item started against a vessel.</span>
                            </span>
                        </label>
                        <input type="number" id="per-work-item-fee" value="15" min="0" step="1">
                    </div>
                </div>
                
                <div class="card">
                    <h2>
                        Customer Usage
                        <span class="info-icon" title="How customers use the platform">ⓘ</span>
                    </h2>
                    <div class="card-description">
                        Define customer usage patterns and onboarding metrics.
                    </div>
                    <div class="form-group">
                        <label for="total-customers">
                            Number of Customers
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The total number of customers subscribed to the platform.</span>
                            </span>
                        </label>
                        <input type="number" id="total-customers-input" value="50" min="1" max="500">
                    </div>
                    <div class="form-group">
                        <label for="vessels-per-customer">
                            Average Vessels Per Customer
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The average number of vessels managed by each customer on the platform.</span>
                            </span>
                        </label>
                        <input type="number" id="vessels-per-customer" value="10" min="1" max="100">
                    </div>
                    <div class="form-group">
                        <label for="onboarding-vessels">
                            New Vessels Onboarding
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The number of new vessels expected to be added to the platform.</span>
                            </span>
                        </label>
                        <input type="number" id="onboarding-vessels" value="50" min="0" max="1000">
                    </div>
                    <div class="form-group">
                        <label for="work-items-per-vessel">
                            Work Items Per Vessel (Annual)
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The average number of work items created per vessel per year.</span>
                            </span>
                        </label>
                        <input type="number" id="work-items-per-vessel" value="12" min="1" max="100">
                    </div>
                    <div class="form-group">
                        <label for="transitions-per-work-item">
                            State Transitions Per Work Item
                            <span class="tooltip-icon">?
                                <span class="tooltip-text">The number of state transitions that occur for each work item. The default of 5 reflects a standard workflow: open, resource, work, review, close.</span>
                            </span>
                        </label>
                        <input type="number" id="transitions-per-work-item" value="5" min="1" max="20">
                    </div>
                </div>
            </div>
            
            <div>
                <div class="card">
                    <h2>
                        Financial Summary
                        <span class="info-icon" title="Key financial metrics">ⓘ</span>
                    </h2>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-title">
                                Annual Revenue
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Total annual revenue from all pricing components</span>
                                </span>
                            </div>
                            <div class="metric-value" id="total-revenue">$0</div>
                            <div class="metric-subtitle" id="monthly-revenue">$0 monthly</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-title">
                                Annual Cost
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Total annual costs including Rise-X fee, operational expenses, and optional developer cost</span>
                                </span>
                            </div>
                            <div class="metric-value" id="total-cost">$0</div>
                            <div class="metric-subtitle" id="monthly-cost">$0 monthly</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-title">
                                Annual Profit
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Annual revenue minus costs</span>
                                </span>
                            </div>
                            <div class="metric-value" id="total-profit">$0</div>
                            <div class="metric-subtitle" id="monthly-profit">$0 monthly</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-title">
                                Break-Even Customers
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Number of customers needed to cover annual costs</span>
                                </span>
                            </div>
                            <div class="metric-value" id="break-even">0</div>
                            <div class="metric-subtitle" id="break-even-percent">0% of current customers</div>
                        </div>
                    </div>
                    
                    <div class="results">
                        <div class="result-item">
                            <span class="result-label">
                                Total Vessels
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Total number of vessels managed on the platform, including newly onboarded ones</span>
                                </span>
                            </span>
                            <span id="total-vessels">0</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">
                                Total Annual Work Items
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Total number of work items created annually across all vessels</span>
                                </span>
                            </span>
                            <span id="total-work-items">0</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">
                                Total Monthly State Transitions
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Total monthly state transitions based on work items and transition count</span>
                                </span>
                            </span>
                            <span id="total-transitions">0</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">
                                Included Transitions
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Number of state transitions included in the Rise-X monthly fee</span>
                                </span>
                            </span>
                            <span id="included-transitions">0</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">
                                Transition Usage
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Percentage of included transitions being used</span>
                                </span>
                            </span>
                            <span id="transition-usage">0%</span>
                            <span id="usage-status" class="badge badge-success">Good</span>
                        </div>
                        <div class="progress">
                            <div class="progress-bar" id="transition-progress" style="width: 0%"></div>
                        </div>
                        <div class="result-item">
                            <span class="result-label">
                                Profit Margin
                                <span class="tooltip-icon">?
                                    <span class="tooltip-text">Profit as a percentage of revenue</span>
                                </span>
                            </span>
                            <span id="profit-margin">0%</span>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h2>
                        Revenue Breakdown
                        <span class="info-icon" title="Revenue by component">ⓘ</span>
                    </h2>
                    <div class="card-description">
                        Distribution of revenue across different pricing components.
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Units</th>
                                <th>Price</th>
                                <th>Revenue</th>
                                <th>% of Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Annual Subscription</td>
                                <td id="subscription-count">0</td>
                                <td id="subscription-price">$0</td>
                                <td id="subscription-revenue">$0</td>
                                <td id="subscription-percentage">0%</td>
                            </tr>
                            <tr>
                                <td>Vessel Fees</td>
                                <td id="vessel-count">0</td>
                                <td id="vessel-price">$0</td>
                                <td id="vessel-revenue">$0</td>
                                <td id="vessel-percentage">0%</td>
                            </tr>
                            <tr>
                                <td>Work Item Fees</td>
                                <td id="work-item-count">0</td>
                                <td id="work-item-price">$0</td>
                                <td id="work-item-revenue">$0</td>
                                <td id="work-item-percentage">0%</td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3"><strong>Total Annual Revenue</strong></td>
                                <td id="table-total-revenue">$0</td>
                                <td>100%</td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                
                <div class="callout">
                    <div class="callout-title">Post-2026 Planning</div>
                    <div class="callout-text">
                        Remember that the special condition providing free additional state transitions expires in December 2026. After this date, you may need to adjust your pricing strategy if your customer base exceeds the included transitions limit.
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button id="save-scenario" class="btn">Save Current Scenario</button>
                    <button id="reset-defaults" class="btn btn-reset">Reset to Defaults</button>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Help button and panel -->
    <div class="help-button" id="open-help">?</div>
    
    <div class="help-panel" id="help-panel">
        <div class="help-panel-header">
            <h2>Pricing Calculator Help</h2>
            <button class="close-help" id="close-help">&times;</button>
        </div>
        
        <div class="help-section">
            <h3>Understanding Your Business Model</h3>
            <p>Marinestream leverages Rise-X's SaaS platform to provide digital twin and workflow management for marine vessels. The pricing model is based on three main components: annual subscription, per-vessel fees, and per-work item fees.</p>
        </div>
        
        <div class="help-section">
            <h3>Key Metrics Explained</h3>
            <ul>
                <li><strong>State Transitions:</strong> Each work item tracked in the system involves multiple state changes (open, resource, work, review, close).</li>
                <li><strong>Break-Even Point:</strong> The number of customers needed to cover your fixed costs.</li>
                <li><strong>Special Condition:</strong> Until December 2026, you can exceed the 1,929 included state transitions at no extra cost, allowing for significant growth.</li>
            </ul>
        </div>
        
        <div class="help-section">
            <h3>Pricing Strategy Tips</h3>
            <ul>
                <li>Balance your revenue between the three pricing components to create a sustainable model that aligns costs with usage.</li>
                <li>The Break-Even point is critical. Ensure your pricing allows you to reach it with a realistic number of customers.</li>
                <li>Monitor transition usage. If you're consistently over 90%, you may need to negotiate with Rise-X or adjust your pricing after the special condition expires.</li>
            </ul>
        </div>
        
        <div class="help-section">
            <h3>Using This Calculator</h3>
            <p>Start with one of the predefined scenarios, or create your own by adjusting the inputs. Each input has a tooltip that explains its purpose and impact on the calculations. Use the currency selector to view results in different currencies.</p>
        </div>
    </div>
    
    <footer class="container">
        <p>Marinestream SaaS Pricing Calculator &copy; 2025</p>
    </footer>
    
    <script>
        // Get all input elements
        const riseXFeeInput = document.getElementById('riseX-fee');
        const includedEventsInput = document.getElementById('included-events');
        const additionalCostsInput = document.getElementById('additional-costs');
        const prepayDiscountSelect = document.getElementById('prepay-discount');
        const includeDeveloperCheckbox = document.getElementById('include-developer');
        
        const annualSubscriptionFeeInput = document.getElementById('annual-subscription-fee');
        const perVesselFeeInput = document.getElementById('per-vessel-fee');
        const perWorkItemFeeInput = document.getElementById('per-work-item-fee');
        
        const totalCustomersInput = document.getElementById('total-customers-input');
        const vesselsPerCustomerInput = document.getElementById('vessels-per-customer');
        const onboardingVesselsInput = document.getElementById('onboarding-vessels');
        const workItemsPerVesselInput = document.getElementById('work-items-per-vessel');
        const transitionsPerWorkItemInput = document.getElementById('transitions-per-work-item');
        
        const currencySelect = document.getElementById('currency-select');
        const exchangeRateInfo = document.getElementById('exchange-rate-info');
        
        // Output elements
        const totalRevenueOutput = document.getElementById('total-revenue');
        const monthlyRevenueOutput = document.getElementById('monthly-revenue');
        const totalCostOutput = document.getElementById('total-cost');
        const monthlyCostOutput = document.getElementById('monthly-cost');
        const totalProfitOutput = document.getElementById('total-profit');
        const monthlyProfitOutput = document.getElementById('monthly-profit');
        const breakEvenOutput = document.getElementById('break-even');
        const breakEvenPercentOutput = document.getElementById('break-even-percent');
        
        const totalVesselsOutput = document.getElementById('total-vessels');
        const totalWorkItemsOutput = document.getElementById('total-work-items');
        const totalTransitionsOutput = document.getElementById('total-transitions');
        const includedTransitionsOutput = document.getElementById('included-transitions');
        const transitionUsageOutput = document.getElementById('transition-usage');
        const usageStatusOutput = document.getElementById('usage-status');
        const transitionProgressBar = document.getElementById('transition-progress');
        const profitMarginOutput = document.getElementById('profit-margin');
        
        const subscriptionCountOutput = document.getElementById('subscription-count');
        const vesselCountOutput = document.getElementById('vessel-count');
        const workItemCountOutput = document.getElementById('work-item-count');
        
        const subscriptionPriceOutput = document.getElementById('subscription-price');
        const vesselPriceOutput = document.getElementById('vessel-price');
        const workItemPriceOutput = document.getElementById('work-item-price');
        
        const subscriptionRevenueOutput = document.getElementById('subscription-revenue');
        const vesselRevenueOutput = document.getElementById('vessel-revenue');
        const workItemRevenueOutput = document.getElementById('work-item-revenue');
        const tableTotalRevenueOutput = document.getElementById('table-total-revenue');
        
        const subscriptionPercentageOutput = document.getElementById('subscription-percentage');
        const vesselPercentageOutput = document.getElementById('vessel-percentage');
        const workItemPercentageOutput = document.getElementById('work-item-percentage');
        
        // Scenario and help elements
        const saveScenarioButton = document.getElementById('save-scenario');
        const resetDefaultsButton = document.getElementById('reset-defaults');
        const scenarioButtons = document.querySelectorAll('.scenario-button');
        const helpButton = document.getElementById('open-help');
        const closeHelpButton = document.getElementById('close-help');
        const helpPanel = document.getElementById('help-panel');
        
        // Currency conversion rates (as of March 2025)
        const exchangeRates = {
            AUD: 1.0,
            USD: 0.67, // 1 AUD = 0.67 USD
            GBP: 0.53  // 1 AUD = 0.53 GBP
        };
        
        let currentCurrency = 'AUD';
        
        // Currency symbols
        const currencySymbols = {
            AUD: '$',
            USD: '$',
            GBP: '£'
        };
        
        // Default values for reset
        const defaultValues = {
            riseXFee: 6750,
            includedEvents: 1929,
            additionalCosts: 2000,
            prepayDiscount: "0",
            includeDeveloper: false,
            annualSubscriptionFee: 2000,
            perVesselFee: 200,
            perWorkItemFee: 15,
            totalCustomers: 50,
            vesselsPerCustomer: 10,
            onboardingVessels: 50,
            workItemsPerVessel: 12,
            transitionsPerWorkItem: 5
        };
        
        // Scenario presets
        const scenarios = {
            conservative: {
                annualSubscriptionFee: 2500,
                perVesselFee: 250,
                perWorkItemFee: 20,
                totalCustomers: 30,
                vesselsPerCustomer: 8,
                onboardingVessels: 25,
                workItemsPerVessel: 10
            },
            balanced: {
                annualSubscriptionFee: 2000,
                perVesselFee: 200,
                perWorkItemFee: 15,
                totalCustomers: 50,
                vesselsPerCustomer: 10,
                onboardingVessels: 50,
                workItemsPerVessel: 12
            },
            aggressive: {
                annualSubscriptionFee: 1800,
                perVesselFee: 180,
                perWorkItemFee: 12,
                totalCustomers: 80,
                vesselsPerCustomer: 12,
                onboardingVessels: 100,
                workItemsPerVessel: 15
            }
        };
        
        // Update calculations when any input changes
        const allInputs = [
            riseXFeeInput, includedEventsInput, additionalCostsInput, prepayDiscountSelect, includeDeveloperCheckbox,
            annualSubscriptionFeeInput, perVesselFeeInput, perWorkItemFeeInput,
            totalCustomersInput, vesselsPerCustomerInput, onboardingVesselsInput, workItemsPerVesselInput, transitionsPerWorkItemInput
        ];
        
        allInputs.forEach(input => {
            input.addEventListener('input', calculateResults);
            input.addEventListener('change', calculateResults);
        });
        
        // Currency selector event listener
        currencySelect.addEventListener('change', function() {
            currentCurrency = this.value;
            exchangeRateInfo.textContent = `Base currency: AUD, showing values in ${currentCurrency}`;
            calculateResults();
        });
        
        // Reset to defaults button
        resetDefaultsButton.addEventListener('click', resetToDefaults);
        
        // Scenario buttons
        scenarioButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                scenarioButtons.forEach(btn => btn.classList.remove('active'));
                // Add active class to clicked button
                button.classList.add('active');
                
                // Apply scenario
                if (button.id === 'scenario-conservative') {
                    applyScenario('conservative');
                } else if (button.id === 'scenario-balanced') {
                    applyScenario('balanced');
                } else if (button.id === 'scenario-aggressive') {
                    applyScenario('aggressive');
                }
                // For custom, do nothing as it's already configured by the user
            });
        });
        
        // Help panel toggle
        helpButton.addEventListener('click', () => {
            helpPanel.classList.add('open');
        });
        
        closeHelpButton.addEventListener('click', () => {
            helpPanel.classList.remove('open');
        });
        
        // Function to convert AUD to selected currency
        function convertCurrency(valueInAUD) {
            return valueInAUD * exchangeRates[currentCurrency];
        }
        
        // Function to format currency based on selected currency
        function formatCurrency(valueInAUD) {
            const convertedValue = convertCurrency(valueInAUD);
            return currencySymbols[currentCurrency] + convertedValue.toLocaleString(undefined, { minimumFractionDigits: 0, maximumFractionDigits: 0 });
        }
        
        // Function to apply a scenario
        function applyScenario(scenarioName) {
            const scenario = scenarios[scenarioName];
            
            annualSubscriptionFeeInput.value = scenario.annualSubscriptionFee;
            perVesselFeeInput.value = scenario.perVesselFee;
            perWorkItemFeeInput.value = scenario.perWorkItemFee;
            
            totalCustomersInput.value = scenario.totalCustomers;
            vesselsPerCustomerInput.value = scenario.vesselsPerCustomer;
            onboardingVesselsInput.value = scenario.onboardingVessels;
            workItemsPerVesselInput.value = scenario.workItemsPerVessel;
            
            calculateResults();
        }
        
        // Function to reset all inputs to default values
        function resetToDefaults() {
            riseXFeeInput.value = defaultValues.riseXFee;
            includedEventsInput.value = defaultValues.includedEvents;
            additionalCostsInput.value = defaultValues.additionalCosts;
            prepayDiscountSelect.value = defaultValues.prepayDiscount;
            includeDeveloperCheckbox.checked = defaultValues.includeDeveloper;
            
            annualSubscriptionFeeInput.value = defaultValues.annualSubscriptionFee;
            perVesselFeeInput.value = defaultValues.perVesselFee;
            perWorkItemFeeInput.value = defaultValues.perWorkItemFee;
            
            totalCustomersInput.value = defaultValues.totalCustomers;
            vesselsPerCustomerInput.value = defaultValues.vesselsPerCustomer;
            onboardingVesselsInput.value = defaultValues.onboardingVessels;
            workItemsPerVesselInput.value = defaultValues.workItemsPerVessel;
            transitionsPerWorkItemInput.value = defaultValues.transitionsPerWorkItem;
            
            // Reset scenario buttons
            scenarioButtons.forEach(btn => btn.classList.remove('active'));
            document.getElementById('scenario-custom').classList.add('active');
            
            calculateResults();
        }
        
        // Function to calculate and update results
        function calculateResults() {
            // Get all input values
            const riseXFee = parseFloat(riseXFeeInput.value) || 0;
            const includedEvents = parseInt(includedEventsInput.value) || 0;
            const additionalCosts = parseFloat(additionalCostsInput.value) || 0;
            const prepayDiscount = parseFloat(prepayDiscountSelect.value) || 0;
            const includeDeveloper = includeDeveloperCheckbox.checked;
            
            const annualSubscriptionFee = parseFloat(annualSubscriptionFeeInput.value) || 0;
            const perVesselFee = parseFloat(perVesselFeeInput.value) || 0;
            const perWorkItemFee = parseFloat(perWorkItemFeeInput.value) || 0;
            
            const totalCustomers = parseInt(totalCustomersInput.value) || 0;
            const vesselsPerCustomer = parseInt(vesselsPerCustomerInput.value) || 0;
            const onboardingVessels = parseInt(onboardingVesselsInput.value) || 0;
            const workItemsPerVessel = parseInt(workItemsPerVesselInput.value) || 0;
            const transitionsPerWorkItem = parseInt(transitionsPerWorkItemInput.value) || 0;
            
            // Calculate cost components
            const discountedRiseXFee = riseXFee * (1 - prepayDiscount);
            const annualRiseXFee = discountedRiseXFee * 12;
            const annualAdditionalCosts = additionalCosts * 12;
            const developerCost = includeDeveloper ? 100000 : 0;
            
            const totalAnnualCost = annualRiseXFee + annualAdditionalCosts + developerCost;
            const totalMonthlyCost = totalAnnualCost / 12;
            
            // Calculate existing and new vessels
            const existingVessels = totalCustomers * vesselsPerCustomer;
            const totalVessels = existingVessels + onboardingVessels;
            
            // Calculate revenue components
            const subscriptionRevenue = totalCustomers * annualSubscriptionFee;
            const vesselRevenue = totalVessels * perVesselFee;
            const totalAnnualWorkItems = totalVessels * workItemsPerVessel;
            const workItemRevenue = totalAnnualWorkItems * perWorkItemFee;
            
            const totalAnnualRevenue = subscriptionRevenue + vesselRevenue + workItemRevenue;
            const totalMonthlyRevenue = totalAnnualRevenue / 12;
            
            // Calculate profit metrics
            const totalAnnualProfit = totalAnnualRevenue - totalAnnualCost;
            const totalMonthlyProfit = totalAnnualProfit / 12;
            const profitMargin = totalAnnualRevenue > 0 ? (totalAnnualProfit / totalAnnualRevenue) * 100 : 0;
            
            // Calculate work items and state transitions
            const monthlyWorkItems = totalAnnualWorkItems / 12;
            const monthlyTransitions = monthlyWorkItems * transitionsPerWorkItem;
            
            const transitionUsage = includedEvents > 0 ? (monthlyTransitions / includedEvents) * 100 : 0;
            
            // Calculate break-even customers
            const revenuePerCustomer = annualSubscriptionFee + (vesselsPerCustomer * perVesselFee) + (vesselsPerCustomer * workItemsPerVessel * perWorkItemFee);
            const breakEven = revenuePerCustomer > 0 ? Math.ceil(totalAnnualCost / revenuePerCustomer) : 0;
            const breakEvenPercent = totalCustomers > 0 ? (breakEven / totalCustomers) * 100 : 0;
            
            // Calculate revenue percentages
            const subscriptionPercentage = totalAnnualRevenue > 0 ? (subscriptionRevenue / totalAnnualRevenue) * 100 : 0;
            const vesselPercentage = totalAnnualRevenue > 0 ? (vesselRevenue / totalAnnualRevenue) * 100 : 0;
            const workItemPercentage = totalAnnualRevenue > 0 ? (workItemRevenue / totalAnnualRevenue) * 100 : 0;
            
            // Update all outputs with currency formatting
            totalRevenueOutput.textContent = formatCurrency(totalAnnualRevenue);
            monthlyRevenueOutput.textContent = formatCurrency(totalMonthlyRevenue) + ' monthly';
            totalCostOutput.textContent = formatCurrency(totalAnnualCost);
            monthlyCostOutput.textContent = formatCurrency(totalMonthlyCost) + ' monthly';
            totalProfitOutput.textContent = formatCurrency(totalAnnualProfit);
            monthlyProfitOutput.textContent = formatCurrency(totalMonthlyProfit) + ' monthly';
            totalProfitOutput.className = "metric-value " + (totalAnnualProfit >= 0 ? "profit-positive" : "profit-negative");
            breakEvenOutput.textContent = breakEven;
            breakEvenPercentOutput.textContent = `${Math.round(breakEvenPercent)}% of current customers`;
            
            totalVesselsOutput.textContent = totalVessels.toLocaleString();
            totalWorkItemsOutput.textContent = totalAnnualWorkItems.toLocaleString();
            totalTransitionsOutput.textContent = Math.round(monthlyTransitions).toLocaleString();
            includedTransitionsOutput.textContent = includedEvents.toLocaleString();
            transitionUsageOutput.textContent = Math.round(transitionUsage) + "%";
            
            // Update usage status
            if (transitionUsage > 90) {
                usageStatusOutput.textContent = "High Usage";
                usageStatusOutput.className = "badge badge-danger";
            } else if (transitionUsage > 75) {
                usageStatusOutput.textContent = "Moderate";
                usageStatusOutput.className = "badge badge-warning";
            } else {
                usageStatusOutput.textContent = "Good";
                usageStatusOutput.className = "badge badge-success";
            }
            
            // Update progress bar
            transitionProgressBar.style.width = Math.min(100, transitionUsage) + "%";
            if (transitionUsage > 90) {
                transitionProgressBar.className = "progress-bar progress-bar-danger";
            } else if (transitionUsage > 75) {
                transitionProgressBar.className = "progress-bar progress-bar-warning";
            } else {
                transitionProgressBar.className = "progress-bar progress-bar-success";
            }
            
            profitMarginOutput.textContent = Math.round(profitMargin) + "%";
            profitMarginOutput.className = profitMargin >= 0 ? "profit-positive" : "profit-negative";
            
            // Update revenue breakdown table
            subscriptionCountOutput.textContent = totalCustomers;
            vesselCountOutput.textContent = totalVessels;
            workItemCountOutput.textContent = totalAnnualWorkItems.toLocaleString();
            
            subscriptionPriceOutput.textContent = formatCurrency(annualSubscriptionFee);
            vesselPriceOutput.textContent = formatCurrency(perVesselFee);
            workItemPriceOutput.textContent = formatCurrency(perWorkItemFee);
            
            subscriptionRevenueOutput.textContent = formatCurrency(subscriptionRevenue);
            vesselRevenueOutput.textContent = formatCurrency(vesselRevenue);
            workItemRevenueOutput.textContent = formatCurrency(workItemRevenue);
            tableTotalRevenueOutput.textContent = formatCurrency(totalAnnualRevenue);
            
            subscriptionPercentageOutput.textContent = Math.round(subscriptionPercentage) + "%";
            vesselPercentageOutput.textContent = Math.round(vesselPercentage) + "%";
            workItemPercentageOutput.textContent = Math.round(workItemPercentage) + "%";
        }
        
        // Initialize calculations
        calculateResults();
    </script>
</body>
</html>